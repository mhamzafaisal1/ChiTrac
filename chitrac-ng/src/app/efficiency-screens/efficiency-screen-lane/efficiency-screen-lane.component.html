<div class="efficiency-lane" [ngSwitch]="mode">
  <!-- Operator or OEE: running-style lane with bars -->
  <ng-container *ngSwitchCase="'operator'">
    <div class="lane-background" [ngClass]="isNoOperator ? 'lane-greyed-bg' : 'lane-running-bg'">
      <div class="lane-inner">
        <div class="operator-block" [ngClass]="{
          'no-operator': isNoOperator,
          'red': getSlots().lastSixMinutes.color === 'red',
          'green': getSlots().lastSixMinutes.color === 'green',
          'yellow': getSlots().lastSixMinutes.color === 'yellow'
        }">
          <div class="operator-text">
            <div class="operator-content">{{ getHeaderLabel() }}</div>
          </div>
        </div>
        <div class="data-block">
          <div class="efficiency-value" [ngClass]="{
            'red': getSlots().lastSixMinutes.color === 'red',
            'green': getSlots().lastSixMinutes.color === 'green',
            'yellow': getSlots().lastSixMinutes.color === 'yellow'
          }">
            <div class="value-text">{{ getSlots().lastSixMinutes.value | number: '1.0-0' }}%</div>
          </div>
          <div class="bars-container">
            <div class="bars">
              <div class="bar-item" style="margin: 10px 5px 0 0;">
                <div class="bar-chart">
                  <div class="bar-value">{{ getSlots().lastFifteenMinutes.value | number: '1.0-0' }}%</div>
                  <div class="bar-fill" [style.height.%]="getSlots().lastFifteenMinutes.value" [ngClass]="{
                    'red': getSlots().lastFifteenMinutes.color === 'red',
                    'green': getSlots().lastFifteenMinutes.color === 'green',
                    'yellow': getSlots().lastFifteenMinutes.color === 'yellow'
                  }"></div>
                </div>
                <div class="bar-label">{{ getSlots().lastFifteenMinutes.label }}</div>
              </div>
              <div class="bar-item" style="margin: 10px 2px 0 2px;">
                <div class="bar-chart">
                  <div class="bar-value">{{ getSlots().lastHour.value | number: '1.0-0' }}%</div>
                  <div class="bar-fill" [style.height.%]="getSlots().lastHour.value" [ngClass]="{
                    'red': getSlots().lastHour.color === 'red',
                    'green': getSlots().lastHour.color === 'green',
                    'yellow': getSlots().lastHour.color === 'yellow'
                  }"></div>
                </div>
                <div class="bar-label">{{ getSlots().lastHour.label }}</div>
              </div>
              <div class="bar-item" style="margin: 10px 0 0 5px;">
                <div class="bar-chart">
                  <div class="bar-value">{{ getSlots().today.value | number: '1.0-0' }}%</div>
                  <div class="bar-fill" [style.height.%]="getSlots().today.value" [ngClass]="{
                    'red': getSlots().today.color === 'red',
                    'green': getSlots().today.color === 'green',
                    'yellow': getSlots().today.color === 'yellow'
                  }"></div>
                </div>
                <div class="bar-label">{{ getSlots().today.label }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="item-block item-block-running" [ngClass]="{'item-block-greyed': isNoOperator}">
      <div class="item-line">{{ lane?.machine }}</div>
      <div class="item-line">{{ lane?.batch?.item }}</div>
      <div class="item-line">{{ lane?.batch?.code }}</div>
    </div>
  </ng-container>

  <ng-container *ngSwitchCase="'oee'">
    <div class="lane-background lane-running-bg">
      <div class="lane-inner">
        <div class="operator-block" [ngClass]="{
          'red': getSlots().lastSixMinutes.color === 'red',
          'green': getSlots().lastSixMinutes.color === 'green',
          'yellow': getSlots().lastSixMinutes.color === 'yellow'
        }">
          <div class="operator-text">
            <div class="operator-content">{{ getHeaderLabel() }}</div>
          </div>
        </div>
        <div class="data-block">
          <div class="efficiency-value" [ngClass]="{
            'red': getSlots().lastSixMinutes.color === 'red',
            'green': getSlots().lastSixMinutes.color === 'green',
            'yellow': getSlots().lastSixMinutes.color === 'yellow'
          }">
            <div class="value-text">{{ getSlots().lastSixMinutes.value | number: '1.0-0' }}%</div>
          </div>
          <div class="bars-container">
            <div class="bars">
              <div class="bar-item" style="margin: 10px 5px 0 0;">
                <div class="bar-chart">
                  <div class="bar-value">{{ getSlots().lastFifteenMinutes.value | number: '1.0-0' }}%</div>
                  <div class="bar-fill" [style.height.%]="getSlots().lastFifteenMinutes.value" [ngClass]="{
                    'red': getSlots().lastFifteenMinutes.color === 'red',
                    'green': getSlots().lastFifteenMinutes.color === 'green',
                    'yellow': getSlots().lastFifteenMinutes.color === 'yellow'
                  }"></div>
                </div>
                <div class="bar-label">{{ getSlots().lastFifteenMinutes.label }}</div>
              </div>
              <div class="bar-item" style="margin: 10px 2px 0 2px;">
                <div class="bar-chart">
                  <div class="bar-value">{{ getSlots().lastHour.value | number: '1.0-0' }}%</div>
                  <div class="bar-fill" [style.height.%]="getSlots().lastHour.value" [ngClass]="{
                    'red': getSlots().lastHour.color === 'red',
                    'green': getSlots().lastHour.color === 'green',
                    'yellow': getSlots().lastHour.color === 'yellow'
                  }"></div>
                </div>
                <div class="bar-label">{{ getSlots().lastHour.label }}</div>
              </div>
              <div class="bar-item" style="margin: 10px 0 0 5px;">
                <div class="bar-chart">
                  <div class="bar-value">{{ getSlots().today.value | number: '1.0-0' }}%</div>
                  <div class="bar-fill" [style.height.%]="getSlots().today.value" [ngClass]="{
                    'red': getSlots().today.color === 'red',
                    'green': getSlots().today.color === 'green',
                    'yellow': getSlots().today.color === 'yellow'
                  }"></div>
                </div>
                <div class="bar-label">{{ getSlots().today.label }}</div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div class="item-block item-block-running">
      <div class="item-line">{{ lane?.machine }}</div>
      <div class="item-line">{{ lane?.batch?.item }}</div>
      <div class="item-line">{{ lane?.batch?.code }}</div>
    </div>
  </ng-container>

  <!-- Offline / stopped (status 0 or -1) -->
  <ng-container *ngSwitchCase="'offline'">
    <div class="lane-background lane-stop-bg">
      <div class="lane-inner">
        <div class="operator-block stopped">
          <div class="operator-text">
            <div class="operator-content">{{ lane?.operator || 'NO OPERATOR' }}</div>
          </div>
        </div>
        <div class="data-block stopped">
          <div class="fault-display">
            <div style="height: 40%;"></div>
            <div class="fault-text">{{ lane?.fault }}</div>
          </div>
          <div class="timer-display">
            <div class="timer-text">ELAPSED TIME: {{ lane?.displayTimers?.on }}</div>
          </div>
        </div>
      </div>
    </div>
    <div class="item-block item-block-stopped">
      <div class="item-line">{{ lane?.machine }}</div>
      <div class="item-line">{{ lane?.batch?.item }}</div>
      <div class="item-line">{{ lane?.batch?.code }}</div>
    </div>
  </ng-container>

  <!-- Fault (status > 1) -->
  <ng-container *ngSwitchCase="'fault'">
    <div class="lane-background lane-fault-bg">
      <div class="lane-inner">
        <div class="operator-block fault">
          <div class="operator-text">
            <div class="operator-content">{{ lane?.operator || 'NO OPERATOR' }}</div>
          </div>
        </div>
        <div class="data-block fault">
          <div class="fault-display">
            <div style="height: 40%;"></div>
            <div class="fault-text">{{ lane?.fault }}</div>
            <div class="fault-label">FAULT</div>
            <div class="fault-code">CODE: {{ lane?.status }}</div>
          </div>
          <div class="timer-display">
            <div class="timer-text">ELAPSED TIME: {{ lane?.displayTimers?.on }}</div>
          </div>
        </div>
      </div>
    </div>
    <div class="item-block item-block-fault">
      <div class="item-line">{{ lane?.machine }}</div>
      <div class="item-line">{{ lane?.batch?.item }}</div>
      <div class="item-line">{{ lane?.batch?.code }}</div>
    </div>
  </ng-container>
</div>
